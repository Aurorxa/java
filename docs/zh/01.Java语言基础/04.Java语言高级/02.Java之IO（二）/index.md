# ç¬¬ä¸€ç« ï¼šIO æµï¼ˆâ­ï¼‰

## 1.1 æ¦‚è¿°

### 1.1.1 ç®€ä»‹

- I/O æ˜¯ Input å’Œ Output çš„ç¼©å†™ï¼ŒIO æŠ€æœ¯æ˜¯éå¸¸å®ç”¨çš„æŠ€æœ¯ï¼Œç”¨äº `å¤„ç†è®¾å¤‡ä¹‹é—´çš„æ•°æ®ä¼ è¾“` ï¼Œå¦‚ï¼šè¯»å†™æ–‡ä»¶ã€ç½‘ç»œé€šè®¯ç­‰ã€‚

> [!NOTE]
>
> IO æµæ˜¯å­˜å‚¨æ•°æ®å’Œè¯»å–æ•°æ®çš„è§£å†³æ–¹æ¡ˆï¼ï¼ï¼

- å› ä¸º IO æµå’Œ File æ¯æ¯ç›¸å…³ï¼›æ‰€ä»¥ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å…ˆå›é¡¾ File ã€‚

### 1.1.2 File å’Œ IO æµ

* File æ˜¯ç”¨æ¥è¡¨ç¤ºç³»ç»Ÿä¸­`æ–‡ä»¶`æˆ–è€…æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ File å®Œæˆä»¥ä¸‹åŠŸèƒ½ï¼š
  * â‘  è·å–æ–‡ä»¶ä¿¡æ¯ï¼ˆå¤§å°ã€æ–‡ä»¶åã€æœ€åä¿®æ”¹æ—¶é—´ï¼‰ã€‚
  * â‘¡ åˆ¤æ–­æ–‡ä»¶çš„ç±»å‹ï¼ˆæ–‡ä»¶è¿˜æ˜¯æ–‡ä»¶å¤¹ï¼‰ã€‚
  * â‘¢ åˆ›å»ºæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ã€‚
  * â‘£ åˆ é™¤æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ã€‚
  * â‘¤ ....

> [!CAUTION]
>
> * File ç±»åªèƒ½å¯¹æ–‡ä»¶æ–‡æœ¬è¿›è¡Œæ“ä½œï¼Œå¹¶ä¸èƒ½è¯»å†™æ–‡ä»¶é‡Œé¢å­˜å‚¨çš„æ•°æ®ï¼ï¼ï¼
> * å¦‚æœè¦è¿›è¡Œè¯»å†™æ•°æ®ï¼Œå¿…é¡»è¦ä½¿ç”¨ IO æµæŠ€æœ¯ã€‚

* IO æµæ˜¯ç”¨æ¥è¯»å†™æ–‡ä»¶ä¸­çš„æ•°æ®ï¼ˆå¯ä»¥è¯»å†™æ–‡ä»¶ï¼Œæˆ–ç½‘ç»œä¸­çš„æ•°æ®...ï¼‰ã€‚
* å…¶ä¸­ï¼ŒIO æµå¯ä»¥å°†ç¨‹åºä¸­çš„æ•°æ®ä¿å­˜ï¼ˆå†™å‡ºï¼‰åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºï¼š`å†™`ï¼ˆOutputï¼Œå†™å‡ºæ•°æ®ï¼‰ã€‚

![](./assets/1.png)

* å…¶ä¸­ï¼ŒIO æµå¯ä»¥å°†æœ¬åœ°æ–‡ä»¶ä¸­çš„æ•°æ®è¯»å–ï¼ˆåŠ è½½ï¼‰åˆ°ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºï¼š`è¯»`ï¼ˆInputï¼Œè¯»å–æ•°æ®ï¼‰ã€‚

![](./assets/2.png)

* åœ¨ IO æµä¸­ï¼Œæ˜¯ä»¥`ç¨‹åº`ä½œä¸ºå‚ç…§ç‰©æ¥çœ‹è¯»å†™çš„æ–¹å‘çš„ã€‚

> [!NOTE]
>
> * â‘  æ˜¯ç¨‹åºåœ¨è¯»å–æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œä¹Ÿæ˜¯ç¨‹åºåœ¨å‘æ–‡ä»¶ä¸­å†™å‡ºæ•°æ®ã€‚
> * â‘¡ å› ä¸ºç¨‹åºæ˜¯è¿è¡Œåœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥å°†`å†…å­˜`ä½œä¸ºå‚ç…§ç‰©æ¥çœ‹è¯»å†™çš„æ–¹å‘çš„ã€‚

![](./assets/3.svg)

### 1.1.3 IO æµåˆ†ç±»

* åœ¨ Java ä¸­ï¼ŒIO æµæœ‰å¾ˆå¤šå¾ˆå¤šç§ï¼ˆBIOï¼ŒBlocking I/Oï¼Œé˜»å¡å¼ I/Oï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

> [!NOTE]
>
> åœ¨ Java ä¸­ï¼ŒIO æµçš„æ¨¡å‹åˆ†ä¸ºä»¥ä¸‹å‡ ç§ï¼š
>
> | åç§° | å…¨ç§°             | ä¸­æ–‡å«ä¹‰   | æ¨¡å‹ç±»å‹   |
> | ---- | ---------------- | ---------- | ---------- |
> | BIO  | Blocking I/O     | é˜»å¡å¼ I/O | åŒæ­¥é˜»å¡   |
> | NIO  | Non-blocking I/O | éé˜»å¡ I/O | åŒæ­¥éé˜»å¡ |
> | AIO  | Asynchronous I/O | å¼‚æ­¥ I/O   | å¼‚æ­¥éé˜»å¡ |
>
> ç›®å‰ï¼Œæˆ‘ä»¬å­¦ä¹ çš„æ˜¯ BIOï¼Œå³ï¼šé˜»å¡å¼ I/Oï¼Œè‡³äºä»€ä¹ˆæ˜¯é˜»å¡å¼ I/Oï¼Œåœ¨å¤šçº¿ç¨‹å’Œç½‘ç»œç¼–ç¨‹é‚£è¾¹è®²è§£ï¼ï¼ï¼

```txt
â”œâ”€ğŸ“„ Bits.java
â”œâ”€ğŸ“„ BufferedInputStream.java
â”œâ”€ğŸ“„ BufferedOutputStream.java
â”œâ”€ğŸ“„ BufferedReader.java
â”œâ”€ğŸ“„ BufferedWriter.java
â”œâ”€ğŸ“„ ByteArrayInputStream.java
â”œâ”€ğŸ“„ ByteArrayOutputStream.java
â”œâ”€ğŸ“„ CharArrayReader.java
â”œâ”€ğŸ“„ CharArrayWriter.java
â”œâ”€ğŸ“„ CharConversionException.java
...
â”œâ”€ğŸ“„ DataOutput.java
â”œâ”€ğŸ“„ DataOutputStream.java
â”œâ”€ğŸ“„ DefaultFileSystem.java
â”œâ”€ğŸ“„ DeleteOnExitHook.java
â”œâ”€ğŸ“„ EOFException.java
â”œâ”€ğŸ“„ ExpiringCache.java
â”œâ”€ğŸ“„ Externalizable.java
...
â”œâ”€ğŸ“„ FileCleanable.java
â”œâ”€ğŸ“„ FileDescriptor.java
â”œâ”€ğŸ“„ FileFilter.java
â”œâ”€ğŸ“„ FileInputStream.java
â”œâ”€ğŸ“„ FilenameFilter.java
â”œâ”€ğŸ“„ FileNotFoundException.java
â”œâ”€ğŸ“„ FileOutputStream.java
...
```

> [!NOTE]
>
> ä¸ºäº†æ›´å¥½çš„å­¦ä¹  IO æµï¼Œæˆ‘ä»¬æœ‰å¿…è¦å…ˆå¯¹å®ƒä»¬è¿›è¡Œåˆ†ç±»ï¼Œå³ï¼šå…ˆæœ‰ä¸€ä¸ªæ•´ä½“çš„è®¤è¯†ï¼Œå†ä¸€ä¸ªä¸ªçš„å­¦ä¹ ã€‚

* æ ¹æ®`æµçš„æ–¹å‘`ï¼Œæˆ‘ä»¬å¯ä»¥å°† IO æµï¼Œåšå¦‚ä¸‹çš„åˆ†ç±»ï¼š

![æŒ‰ç…§æµçš„æ–¹å‘ï¼Œè¿›è¡Œ IO æµçš„åˆ†ç±»](./assets/4.svg)

* æ ¹æ®`æ“ä½œæ–‡ä»¶çš„ç±»å‹`ï¼Œæˆ‘ä»¬å¯ä»¥å°† IO æµï¼Œåšå¦‚ä¸‹çš„åˆ†ç±»ï¼š

> [!NOTE]
>
> * â‘  å­—èŠ‚æµå¯ä»¥æ“ä½œæ‰€æœ‰ç±»å‹çš„æ–‡ä»¶ï¼ŒåŒ…æ‹¬ï¼šå›¾ç‰‡æ–‡ä»¶ã€æ–‡æœ¬æ–‡ä»¶ã€éŸ³é¢‘æ–‡ä»¶ä»¥åŠè§†é¢‘æ–‡ä»¶ç­‰ç­‰ã€‚
> * â‘¡ å­—ç¬¦æµå¯ä»¥æ“ä½œæ–‡æœ¬ç±»å‹çš„æ–‡ä»¶ã€‚

![æŒ‰ç…§æ“ä½œæ–‡ä»¶çš„ç±»å‹ï¼Œè¿›è¡Œ IO æµçš„åˆ†ç±»](./assets/5.svg)



* å¯¹äºçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œæœ€ç®€å•çš„åˆ¤æ–­æ–¹å¼ï¼šä½¿ç”¨ Windows è‡ªå¸¦çš„è®°äº‹æœ¬è½¯ä»¶ã€‚

> [!NOTE]
>
> * â‘  å¦‚æœæŸä¸ªæ–‡ä»¶ï¼ŒWindows è‡ªå¸¦çš„è®°äº‹æœ¬è½¯ä»¶èƒ½æ‰“å¼€ï¼Œæ˜¾ç¤ºå‡ºæ¥ä¸ä¹±ç ï¼Œå°±æ˜¯çº¯æ–‡æœ¬æ–‡ä»¶ã€‚
> * â‘¡ å¦‚æœæŸä¸ªæ–‡ä»¶ï¼ŒWindows è‡ªå¸¦çš„è®°äº‹æœ¬è½¯ä»¶èƒ½æ‰“å¼€ï¼›ä½†æ˜¯ï¼Œæ˜¾ç¤ºå‡ºæ¥ä¹±ç ï¼Œå°±ä¸æ˜¯çº¯æ–‡æœ¬æ–‡ä»¶ã€‚

![åªæœ‰`*.txt`å’Œ`*.md`æ‰æ˜¯æ–‡æœ¬æ–‡æœ¬](./assets/6.gif)

## 1.2 IO æµä½“ç³»

* IO æµæŒ‰ç…§`æ“ä½œæ–‡ä»¶çš„ç±»å‹`è¿›è¡Œåˆ†ç±»ï¼Œå¯ä»¥åˆ†ä¸º`å­—èŠ‚æµ`å’Œ`å­—ç¬¦æµ`ï¼š

![IO æµä½“ç³»](./assets/7.svg)

* ä»¥`å­—èŠ‚æµ`ä¸ºä¾‹ï¼ŒæŒ‰ç…§`æµçš„æ–¹å‘`è¿›è¡Œåˆ†ç±»ï¼Œå¯ä»¥åˆ†ä¸º`å­—èŠ‚è¾“å…¥æµ`å’Œ`å­—èŠ‚è¾“å‡ºæµ`ï¼š

![IO æµä½“ç³»](./assets/8.svg)



* ä»¥`å­—ç¬¦æµ`ä¸ºä¾‹ï¼ŒæŒ‰ç…§`æµçš„æ–¹å‘`è¿›è¡Œåˆ†ç±»ï¼Œå¯ä»¥åˆ†ä¸º`å­—ç¬¦è¾“å…¥æµ`å’Œ`å­—ç¬¦è¾“å‡ºæµ`ï¼š

![IO æµä½“ç³»](./assets/9.svg)

* ä½†æ˜¯ï¼ŒInputStreamã€OutputStreamã€Reader ä»¥åŠ Writer éƒ½æ˜¯æŠ½è±¡ç±»ï¼Œæ˜¯ä¸èƒ½å®ä¾‹åŒ–çš„ï¼š

> [!NOTE]
>
> ::: code-group
>
> ```java [InputStream.java]
> public abstract class InputStream implements Closeable {}
> ```
>
> ```java [OutputStream.java]
> public abstract class OutputStream implements Closeable, Flushable {}
> ```
>
> ```java [Reader.java]
> public abstract class Reader implements Readable, Closeable {}
> ```
>
> ```java [Writer.java]
> public abstract class Writer implements Appendable, Closeable, Flushable {}
> ```
>
> :::

![IO æµä½“ç³»](./assets/10.svg)

> [!NOTE]
>
> ä¸ºäº†åˆ›å»ºæµçš„å®ä¾‹ï¼ˆå¯¹è±¡ï¼‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å®ƒä»¬çš„å­ç±»ï¼ï¼ï¼

* ä»¥å­—èŠ‚è¾“å…¥æµï¼ˆInputStreamï¼‰ä¸ºä¾‹ï¼Œå…¶å­ç±»æ˜¯ FileInputStreamï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![IO æµä½“ç³»](./assets/11.svg)

* ä»¥å­—èŠ‚è¾“å‡ºæµï¼ˆOutputStreamï¼‰ä¸ºä¾‹ï¼Œå…¶å­ç±»æ˜¯ FileOutputStreamï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![IO æµä½“ç³»](./assets/12.svg)

* åŒç†ï¼Œå­—ç¬¦è¾“å…¥æµï¼ˆReaderï¼‰å’Œå­—ç¬¦è¾“å‡ºæµï¼ˆWriterï¼‰çš„ç»§æ‰¿ä½“ç³»å°±æ˜¯è¿™æ ·ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![IO æµä½“ç³»](./assets/13.svg)



# ç¬¬äºŒç« ï¼šå­—ç¬¦é›†

## 2.1 æ¦‚è¿°

* ä¹‹å‰ï¼Œæˆ‘ä»¬åœ¨å­¦ä¹ å­—èŠ‚æµçš„æ—¶å€™ï¼Œæè¿‡è¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œæ–‡ä»¶ä¸­çš„å†…å®¹å°½é‡æ˜¯è‹±æ–‡ï¼š

::: code-group

```java [Test.java]
package com.github.file;

import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;

public class Test {
    public static void main(String[] args) throws IOException {
        // åˆ›å»ºè¾“å…¥æµå¯¹è±¡
        InputStream is = new FileInputStream("day23\\a.txt");
        // è¯»å–æ•°æ®
        // ä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œè¯»å–çš„æ•°æ®æ˜¯åœ¨ ASCII ç è¡¨ä¸Šå­—ç¬¦å¯¹åº”çš„æ•°å­—
        // è¯»å–åˆ°æ–‡ä»¶æœ«å°¾ï¼Œè¿”å› -1
        int b;
        while ((b = is.read()) != -1) {
            System.out.println(Character.toChars(b));
        }
        // é‡Šæ”¾èµ„æº
        is.close();

    }
}
```

```md:img [cmd æ§åˆ¶å°]
![](./assets/14.gif)
```

:::

* ä½†æ˜¯ï¼ŒåŠ³èµ„ä¸ä¿¡è¿™ä¸ªé‚ªï¼Œæˆ‘å°±è¦åœ¨è¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œæ–‡ä»¶ä¸­çš„å†…å®¹æ˜¯ä¸­æ–‡ï¼š

::: code-group

```java [Test.java]
package com.github.file;

import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;

public class Test {
    public static void main(String[] args) throws IOException {
        // åˆ›å»ºè¾“å…¥æµå¯¹è±¡
        InputStream is = new FileInputStream("day23\\a.txt");
        // è¯»å–æ•°æ®
        // ä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œè¯»å–çš„æ•°æ®æ˜¯åœ¨ ASCII ç è¡¨ä¸Šå­—ç¬¦å¯¹åº”çš„æ•°å­—
        // è¯»å–åˆ°æ–‡ä»¶æœ«å°¾ï¼Œè¿”å› -1
        int b;
        while ((b = is.read()) != -1) {
            System.out.println(Character.toChars(b));
        }
        // é‡Šæ”¾èµ„æº
        is.close();

    }
}
```

```md:img [cmd æ§åˆ¶å°]
![](./assets/15.gif)
```

:::

> [!IMPORTANT]
>
> æˆ‘ä»¬ä¼šå‘ç°ç»“æœæ˜¯ä¹±ç ï¼Œè¦è§£é‡Šè¿™ä¸ªåŸå› ï¼Œå°±è¦å°†è¦å­¦ä¹ `å­—ç¬¦é›†`å’Œ`ç¼–ç æ–¹å¼ï¼ˆç¼–ç è§„åˆ™ï¼‰`æœ‰å…³äº†ã€‚

## 2.2 è®¡ç®—æœºçš„å­˜å‚¨è§„åˆ™

### 2.2.1 æ¦‚è¿°

* è¦å­¦ä¹ `å­—ç¬¦é›†`å’Œ`ç¼–ç æ–¹å¼ï¼ˆç¼–ç è§„åˆ™ï¼‰`ï¼Œæˆ‘ä»¬æœ‰å¿…è¦å›é¡¾ä¹‹å‰å­¦ä¹ è¿‡çš„`è®¡ç®—æœºçš„å­˜å‚¨è§„åˆ™`ã€‚

### 2.2.2 è®¡ç®—æœºçš„å­˜å‚¨è§„åˆ™

* åœ¨è®¡ç®—æœºä¸­ï¼Œä»»æ„çš„æ•°æ®éƒ½æ˜¯ä»¥äºŒè¿›åˆ¶çš„å½¢å¼è¿›è¡Œå­˜å‚¨çš„ï¼ŒåŒ…æ‹¬ï¼šæ•°å­—ã€å­—ç¬¦ã€å›¾ç‰‡ã€è§†é¢‘ç­‰ã€‚

![](./assets/16.jpg)

* å…¶å®ï¼Œæ‰€è°“çš„äºŒè¿›åˆ¶å°±æ˜¯`0`æˆ–`1`ï¼Œä¸­æ–‡ç§°ä¸ºâ€œæ¯”ç‰¹â€ï¼Œè‹±æ–‡ç§°ä¸ºâ€œbit â€ã€‚

> [!NOTE]
>
> * â‘  1 bit åªèƒ½å­˜å‚¨ 0 æˆ– 1 ï¼Œå¯ä»¥å­˜å‚¨ 2^1 ä¸ªæ•°å­—ï¼Œå³ï¼šå¯ä»¥è¡¨ç¤º 2 ä¸ªæ•°å­—ã€‚
> * â‘¡ è®¡ç®—æœºä¸­æœ€å°çš„å­˜å‚¨å•å…ƒæ˜¯ bit ã€‚

![](./assets/17.svg)

* ä½†æ˜¯ï¼Œä¸€ä¸ª`bit`èƒ½å­˜å‚¨çš„æ•°æ®å¤ªå°‘äº†ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šå°†`8`ä¸ª`bit`åˆ†ä¸ºä¸€ç»„ï¼Œä¸­æ–‡ç§°ä¸ºâ€œå­—èŠ‚â€ï¼Œè‹±æ–‡ç§°ä¸ºâ€œByteâ€ã€‚

> [!NOTE]
>
> * â‘  1 Byte æ˜¯ 8 bitï¼Œå¯ä»¥å­˜å‚¨ 2^8 ä¸ªæ•°å­—ï¼Œå³ï¼šå¯ä»¥è¡¨ç¤º 256 ä¸ªæ•°å­—ã€‚
> * â‘¡ è®¡ç®—æœºä¸­æœ€åŸºæœ¬çš„å­˜å‚¨å•å…ƒæ˜¯ Byte ã€‚

![](./assets/18.svg)

> [!IMPORTANT]
>
> * â‘  è®¡ç®—æœºå­˜å‚¨è‹±æ–‡çš„æ—¶å€™ï¼Œ1 ä¸ªå­—èŠ‚å°±å¯ä»¥äº†ï¼Œå› ä¸ºè‹±æ–‡å­—æ¯ä¸€å…± 26 ä¸ªï¼Œå°±ç®—å¤§å°å†™ä¹Ÿåªæœ‰ 52 ä¸ªã€‚
> * â‘¡ è®¡ç®—æœºåˆ°åº•æ˜¯å¦‚ä½•å­˜å‚¨è‹±æ–‡çš„ï¼Œå°±å’Œå°†è¦å­¦ä¹ çš„`å­—ç¬¦é›†`å’Œ`ç¼–ç æ–¹å¼ï¼ˆç¼–ç è§„åˆ™ï¼‰`æœ‰å…³äº†ã€‚

## 2.3 å­—ç¬¦é›†å’Œç¼–ç æ–¹å¼ï¼ˆç¼–ç è§„åˆ™ï¼‰

### 2.3.1 æ¦‚è¿°

* å­—ç¬¦ï¼ˆCharacterï¼‰æ˜¯å„ç§æ–‡å­—å’Œç¬¦å·çš„æ€»ç§°ï¼Œå¦‚ï¼šå„ä¸ªå›½å®¶çš„æ–‡å­—ã€æ ‡ç‚¹ç¬¦å·ã€æ•°å­—ç¬¦å·ç­‰ã€‚

> [!NOTE]
>
> åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å•å¼•å·`''`æ¥å°†`å­—ç¬¦`æ‹¬èµ·æ¥ï¼Œå¹¶ä½¿ç”¨`char` æ¥è¡¨ç¤º`å­—ç¬¦`çš„`æ•°æ®ç±»å‹`ï¼š
>
> ```java
> char c = '1';
> char c2 = 'A';
> char c3 = 'æˆ‘';
> char c4 = '&';
> ```

* å­—ç¬¦é›†ï¼ˆCharacter Setï¼‰ï¼šå­—ç¬¦é›†æ˜¯å­—ç¬¦çš„é›†åˆï¼Œè§„åˆ™äº†æœ‰å“ªäº›â€œå­—ç¬¦â€å¯ä»¥ä½¿ç”¨ã€‚

> [!NOTE]
>
> å­—ç¬¦é›†å¯ä»¥ç†è§£ä¸ºï¼šæœ‰å“ªäº›å­—ç¬¦å¯ä»¥ç”¨ï¼ï¼ï¼
>
> * â‘  ASCII å­—ç¬¦é›†åŒ…å«äº† A-Zã€a-zã€0-9 ä»¥åŠä¸€äº›æ ‡ç‚¹ç¬¦å·ã€‚
> * â‘¡ Unicode å­—ç¬¦é›†åŒ…å«äº†ä¸–ç•Œä¸Šç»å¤§å¤šæ•°çš„æ–‡å­—å’Œç¬¦å·ï¼Œå¦‚ï¼šä¸­æ–‡ã€æ—¥æ–‡ã€é˜¿æ‹‰ä¼¯æ–‡ã€emoji ç­‰ã€‚
> * â‘¢ å¸¸è§çš„å­—ç¬¦é›†ï¼š`ASCII`ã€`GBK` ä»¥åŠ `Unicode` ã€‚

* ç¼–ç æ–¹å¼ï¼ˆCharacter Encodingï¼Œè®¡ç®—æœºçš„å­˜å‚¨è§„åˆ™ï¼‰ï¼šå°±æ˜¯å¦‚ä½•å°†å­—ç¬¦è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°å­—çš„è§„åˆ™ï¼Œä»¥ä¾¿è®¡ç®—æœºå¯ä»¥è¿›è¡Œå­˜å‚¨å’Œä¼ è¾“ã€‚

> [!NOTE]
>
> ç¼–ç æ–¹å¼å¯ä»¥ç†è§£ä¸ºï¼šå­—ç¬¦æ˜¯å¦‚ä½•è½¬å˜ä¸º 0 æˆ– 1 ã€‚
>
> * â‘  æ¯ä¸ªå­—ç¬¦åˆ†é…ä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶ä»£ç ï¼Œå¦‚ï¼šASCII å­—ç¬¦é›†ï¼Œä½¿ç”¨ 1 ä¸ªå­—èŠ‚å­˜å‚¨è‹±æ–‡å­—ç¬¦ï¼›è€Œ GBK å­—ç¬¦é›†ï¼Œä½¿ç”¨ 2 ä¸ªå­—èŠ‚å­˜å‚¨æ±‰å­—å­—ç¬¦ã€‚
> * â‘¡ åŒä¸€ä¸ªå­—ç¬¦é›†å¯ä»¥æœ‰å¤šç§ç¼–ç æ–¹å¼ï¼Œå¦‚ï¼šUnicode å­—ç¬¦é›†ä¸­çš„ç¼–ç æ–¹å¼æœ‰ UTF-16ã€UTF-32 ä»¥åŠ UTF-8 ã€‚

### 2.3.2 ASCII å­—ç¬¦é›†ï¼ˆASCII ç¼–ç è§„åˆ™ï¼‰

#### 2.3.2.1 ASCII å­—ç¬¦é›†

* ASCII å­—ç¬¦é›†æ˜¯åŸºäº`æ‹‰ä¸å­—æ¯`çš„ä¸€å¥—ç”µè„‘å­—ç¬¦é›†ã€‚

> [!NOTE]
>
> ASCII æ˜¯ American Standard Code for Information Interchangeï¼ˆç¾å›½ä¿¡æ¯äº’æ¢æ ‡å‡†ä»£ç ï¼‰çš„ç¼©å†™ã€‚

![ASCII å­—ç¬¦é›†](./assets/19.png)

* åœ¨ ASCII å­—ç¬¦é›†ä¸­è®°å½•äº† 128 ä¸ªæ•°æ®ï¼ŒåŒ…å«äº† A-Zã€a-zã€0-9 ä»¥åŠä¸€äº›æ ‡ç‚¹ç¬¦å·ã€‚

> [!NOTE]
>
> * â‘  ASCII å­—ç¬¦é›†å¯¹äºå¤§å¤šæ•°åŸºäº`æ‹‰ä¸å­—æ¯`ä½“ç³»çš„å›½å®¶æ¥è¯´å¤Ÿç”¨äº†ï¼Œå¦‚ï¼šç¾å›½ã€è‹±å›½ç­‰ã€‚
> * â‘¡ å­—ç¬¦é›†å¯ä»¥ç†è§£ä¸ºï¼šæœ‰å“ªäº›å­—ç¬¦å¯ä»¥ç”¨ï¼Œå¦‚ï¼š`a`å¯ä»¥ä½¿ç”¨ï¼Œè€Œ`æ±‰`å°±ä¸å¯ä»¥ã€‚

#### 2.3.2.2 ASCII ç¼–ç è§„åˆ™

* åœ¨ ASCII å­—ç¬¦é›†ä¸­è®°å½•äº† 128 ä¸ªæ•°æ®ï¼ŒåŒ…å«äº† A-Zã€a-zã€0-9 ä»¥åŠä¸€äº›æ ‡ç‚¹ç¬¦å·ã€‚

> [!NOTE]
>
> ASCII å­—ç¬¦é›†ä¸­å­—ç¬¦çš„åºå·æ˜¯ 0 - 127 ã€‚

![ASCII å­—ç¬¦é›†](./assets/19.png)

* è®¡ç®—æœºåœ¨å­˜å‚¨ ASCII å­—ç¬¦é›†çš„å­—ç¬¦çš„æ—¶å€™ï¼Œé¦–å…ˆéœ€è¦å» ASCII å­—ç¬¦é›†ä¸­æŸ¥è¯¢å­—ç¬¦å¯¹åº”çš„æ•°å­—ï¼š

![](./assets/20.svg)

* å¯¹äºè‹±æ–‡å­—ç¬¦`a`ï¼Œå…¶åœ¨ ASCII å­—ç¬¦é›†ä¸­çš„æ•°å­—ç¼–å·æ˜¯`97`ï¼Œæ¢ç®—ä¸ºäºŒè¿›åˆ¶æ˜¯`110 0001`ï¼Œéš¾é“å°±è¿™æ ·ç›´æ¥å­˜å‚¨åˆ°è®¡ç®—æœºä¸­ï¼Ÿ

![](./assets/21.svg)

* å½“ç„¶ä¸å¯¹ï¼Œå› ä¸ºè®¡ç®—æœºä¸­æœ€åŸºæœ¬çš„å­˜å‚¨å•å…ƒæ˜¯å­—èŠ‚ï¼ˆByteï¼‰ã€‚

> [!NOTE]
>
> ä¸€ä¸ªå­—èŠ‚æ˜¯ 8 bitï¼Œè€Œ 97 çš„äºŒè¿›åˆ¶åªæœ‰ 7 bit ï¼Œä¸è¶³ä¸€ä¸ªå­—èŠ‚ï¼ˆByteï¼‰ï¼Œæ˜¯ä¸èƒ½ç›´æ¥å­˜å‚¨çš„ï¼ï¼ï¼

![](./assets/18.svg)

* è®¡ç®—æœºéœ€è¦è¿›è¡Œç¼–ç ï¼ˆå°†å­—ç¬¦é›†ä¸­æŸ¥è¯¢åˆ°çš„æ•°æ®ï¼ˆåè¿›åˆ¶æ•°å­—ï¼‰ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™è¿›è¡Œè®¡ç®—ï¼‰ï¼Œå˜ä¸ºè®¡ç®—æœºä¸­å®é™…èƒ½å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°æ®ã€‚

> [!NOTE]
>
> ASCII çš„ç¼–ç æ–¹å¼ï¼ˆç¼–ç è§„åˆ™ï¼Œè®¡ç®—æœºçš„å­˜å‚¨è§„åˆ™ï¼‰ï¼šç›´æ¥åœ¨å‰é¢è¡¥ 0 ï¼Œå½¢æˆ 8 bitã€‚

![](./assets/22.svg)

* å¦‚æœè¦è¿›è¡Œè¯»å–æ“ä½œï¼Œåªéœ€è¦å°†è®¡ç®—æœºä¸­å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œè§£ç ï¼ˆå°†å®é™…å­˜å‚¨åœ¨è®¡ç®—æœºä¸­çš„äºŒè¿›åˆ¶æ•°æ®ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™è¿›è¡Œè®¡ç®—ï¼‰ï¼Œè¿˜åŸä¸ºå­—ç¬¦é›†ä¸­å¯¹åº”çš„æ•°æ®ï¼ˆåè¿›åˆ¶æ•°å­—ï¼‰ï¼š

> [!NOTE]
>
> ASCII çš„è§£ç æ–¹å¼ï¼ˆè§£ç è§„åˆ™ï¼Œè®¡ç®—æœºçš„è§£ç è§„åˆ™ï¼‰ï¼šç›´æ¥è½¬ä¸ºåè¿›åˆ¶ã€‚

![](./assets/23.svg)

* å†æ ¹æ®è·å–åˆ°çš„æ•°æ®ï¼ˆåè¿›åˆ¶æ•°å­—ï¼‰å» ASCII å­—ç¬¦é›†ä¸­æŸ¥è¯¢å¯¹åº”çš„å­—ç¬¦ï¼Œå³ï¼šè‹±æ–‡å­—ç¬¦`a`ï¼š

![](./assets/24.svg)

* ä½†æ˜¯ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šåœ¨ç½‘ç«™ä¸Šä¼šçœ‹åˆ°è¿™æ ·çš„ ASCII è¡¨ï¼Œå…¶å®åªæ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬æŸ¥çœ‹è€Œå·²ï¼ï¼ï¼

![ASCII è¡¨](./assets/25.png)

### 2.3.3 å…¶ä»–å­—ç¬¦é›†

* `ASCII`å­—ç¬¦é›†ä¸­æ˜¯æ²¡æœ‰æ±‰å­—çš„ï¼Œä¸ºäº†åœ¨è®¡ç®—æœºä¸­è¡¨ç¤ºæ±‰å­—ï¼Œå¿…é¡»è®¾è®¡ä¸€ä¸ªå­—ç¬¦é›†ï¼Œè®©æ¯ä¸ªæ±‰å­—å’Œä¸€ä¸ªå”¯ä¸€çš„æ•°å­—äº§ç”Ÿå¯¹åº”å…³ç³»ã€‚
* `GB2312`å­—ç¬¦é›†ï¼š1981 å¹´ 5 æœˆ 1 æ—¥å®æ–½çš„ç®€ä½“ä¸­æ–‡æ±‰å­—ç¼–ç å›½å®¶æ ‡å‡†ã€‚GB2312 å¯¹æ±‰å­—é‡‡ç”¨åŒå­—èŠ‚ç¼–ç ï¼Œæ”¶å½• 7445 ä¸ªå›¾å½¢å­—ç¬¦ï¼Œå…¶ä¸­åŒ…æ‹¬ 6763 ä¸ªæ±‰å­—ã€‚è‡ª 2017 å¹´ 3 æœˆ 23 æ—¥èµ·ï¼Œè¯¥æ ‡å‡†è½¬åŒ–ä¸ºæ¨èæ€§æ ‡å‡†ï¼šGB/T2312-1980ï¼Œä¸å†å¼ºåˆ¶æ‰§è¡Œã€‚

* `BIG5`å­—ç¬¦é›†ï¼šå°æ¹¾åœ°åŒºç¹ä½“ä¸­æ–‡æ ‡å‡†å­—ç¬¦é›†ï¼Œé‡‡ç”¨åŒå­—èŠ‚ç¼–ç ï¼ŒåŸå§‹ç‰ˆæœ¬å…±æ”¶å½• 13053 ä¸ªä¸­æ–‡å­—ï¼Œ1984 å¹´å®æ–½ã€‚åç»­ç‰ˆæœ¬å¢åŠ  F9D6-F9DC ä¸ƒä¸ªæ±‰å­—ï¼Œæ±‰å­—æ€»æ•° 13060 ä¸ªã€‚
* `GBK`å­—ç¬¦é›†ï¼š1995 å¹´ 12 æœˆå‘å¸ƒçš„æ±‰å­—ç¼–ç å›½å®¶æ ‡å‡†ï¼Œæ˜¯å¯¹ GB2312 ç¼–ç çš„æ‰©å……ï¼Œå¯¹æ±‰å­—é‡‡ç”¨åŒå­—èŠ‚ç¼–ç ã€‚GBK å­—ç¬¦é›†å…±æ”¶å½• 21003 ä¸ªæ±‰å­—ï¼ŒåŒ…å«å›½å®¶æ ‡å‡† GB13000-1 ä¸­çš„å…¨éƒ¨ä¸­æ—¥éŸ©æ±‰å­—ï¼Œå’Œ BIG5 ç¼–ç ä¸­çš„æ‰€æœ‰æ±‰å­—ã€‚
* `GB18030`å­—ç¬¦é›†ï¼š2000 å¹´ 3 æœˆ 17 æ—¥å‘å¸ƒçš„æ±‰å­—ç¼–ç å›½å®¶æ ‡å‡†ï¼Œæ˜¯å¯¹ GBK ç¼–ç çš„æ‰©å……ï¼Œè¦†ç›–ä¸­æ–‡ã€æ—¥æ–‡ã€æœé²œè¯­å’Œä¸­å›½å°‘æ•°æ°‘æ—æ–‡å­—ï¼Œå…¶ä¸­æ”¶å½• 27484 ä¸ªæ±‰å­—ã€‚GB18030 å­—ç¬¦é›†é‡‡ç”¨å•å­—èŠ‚ã€åŒå­—èŠ‚å’Œå››å­—èŠ‚ä¸‰ç§æ–¹å¼å¯¹å­—ç¬¦ç¼–ç ã€‚å…¼å®¹ GBK å’Œ GB2312 å­—ç¬¦é›†ã€‚2005 å¹´ 11 æœˆ 8 æ—¥ï¼Œå‘å¸ƒäº†ä¿®è®¢ç‰ˆæœ¬ï¼šGB18030-2005ï¼Œå…±æ”¶å½•æ±‰å­—ä¸ƒä¸‡ä½™ä¸ªã€‚2022 å¹´ 7 æœˆ 19 æ—¥ï¼Œå‘å¸ƒäº†ç¬¬äºŒæ¬¡ä¿®è®¢ç‰ˆæœ¬ï¼šGB18030-2022ï¼Œæ”¶å½•æ±‰å­—æ€»æ•°å…«ä¸‡ä½™ä¸ªã€‚

* `Unicode`å­—ç¬¦é›†ï¼šå›½é™…æ ‡å‡†å­—ç¬¦é›†ï¼Œå®ƒå°†ä¸–ç•Œå„ç§è¯­è¨€çš„æ¯ä¸ªå­—ç¬¦å®šä¹‰ä¸€ä¸ªå”¯ä¸€çš„ç¼–ç ï¼Œä»¥æ»¡è¶³è·¨è¯­è¨€ã€è·¨å¹³å°çš„æ–‡æœ¬ä¿¡æ¯è½¬æ¢ã€‚Unicode é‡‡ç”¨å››ä¸ªå­—èŠ‚ä¸ºæ¯ä¸ªå­—ç¬¦ç¼–ç ã€‚

> [!NOTE]
>
> åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¯¹æˆ‘ä»¬æœ€ä¸ºé‡è¦çš„å°±æ˜¯`GBK`å­—ç¬¦é›†å’Œ`Unicode`å­—ç¬¦é›†ï¼š
>
> * â‘  `GBK`å­—ç¬¦é›†æ˜¯ Windows ç®€ä½“ä¸­æ–‡æ“ä½œç³»ç»Ÿé»˜è®¤çš„å­—ç¬¦é›†ã€‚
> * â‘¡ `Unicode`å­—ç¬¦é›†å’Œæˆ‘ä»¬ä¹‹åçš„å·¥ä½œæ¯æ¯ç›¸å…³ã€‚

### 2.3.4 GBK å­—ç¬¦é›†ï¼ˆGBK ç¼–ç è§„åˆ™ï¼‰

#### 2.3.4.1 å­˜å‚¨è‹±æ–‡

* GBK å­—ç¬¦é›†æ˜¯å…¼å®¹ ASCII å­—ç¬¦é›†ï¼Œå³ï¼šGBK å­—ç¬¦é›†ä¹Ÿæ˜¯ä½¿ç”¨ 1 ä¸ªå­—èŠ‚æ¥å­˜å‚¨è‹±æ–‡çš„ã€‚

![](./assets/26.svg)

#### 2.3.4.2 å­˜å‚¨ä¸­æ–‡

* å‡è®¾è¦å­˜å‚¨çš„ä¸­æ–‡æ˜¯`æ±‰`ï¼Œåœ¨ GBK å­—ç¬¦é›†ä¸­æŸ¥è¯¢åˆ°çš„æ•°å­—ç¼–å·æ˜¯`47802`ï¼Œè½¬æ¢ä¸ºäºŒè¿›åˆ¶æ˜¯`10111010 10111010`ï¼Œéœ€è¦ 2 ä¸ªå­—èŠ‚æ¥å­˜å‚¨ï¼š

![](./assets/27.svg)

* GBK å­—ç¬¦é›†æœ‰å¦‚ä¸‹çš„ä¸¤ä¸ªè§„å¾‹ï¼š
  * â‘  æ±‰å­—ä½¿ç”¨ 2 ä¸ªå­—èŠ‚å­˜å‚¨ï¼ˆç†è®ºä¸Šå¯ä»¥å­˜å‚¨ 2^16 = 65536 ä¸ªå­—ç¬¦ï¼Œå®é™…ä¸Šä¸€å…±å­˜å‚¨äº†21886 ä¸ªå­—ç¬¦ ï¼‰ã€‚
  * â‘¡ é«˜ä½å­—èŠ‚çš„äºŒè¿›åˆ¶ä¸€å®šä»¥ 1 å¼€å¤´ï¼Œè½¬ä¸ºåè¿›åˆ¶ä¹‹åå°±æ˜¯è´Ÿæ•°ï¼Œå¦‚ï¼š47802 è½¬æ¢ä¸ºåè¿›åˆ¶å°±æ˜¯ `-70, -70`ã€‚

> [!NOTE]
>
> ä¹‹æ‰€ä»¥è¿™ä¹ˆè®¾è®¡ï¼Œå°±æ˜¯ä¸ºäº†å…¼å®¹ ASCII å­—ç¬¦é›†ï¼š
>
> * â‘  ASCII å­—ç¬¦é›†ï¼ˆGBK å­—ç¬¦é›†å…¼å®¹ï¼‰åœ¨è¿›è¡Œå­—ç¬¦å­˜å‚¨çš„æ—¶å€™ï¼Œæ˜¯äºŒè¿›åˆ¶å‰è¡¥ 0ï¼Œå³ï¼šä»¥ `0` å¼€å¤´ ã€‚
> * â‘¡ GBK å­—ç¬¦é›†åœ¨å­˜å‚¨æ±‰å­—çš„æ—¶å€™ï¼ŒäºŒè¿›åˆ¶æ˜¯ä»¥ `1` å¼€å¤´çš„ã€‚
>
> åº•å±‚ä¹Ÿæ­£æ˜¯é€šè¿‡ä¸Šè¿°çš„è§„åˆ™æ¥åŒºåˆ†åˆ°åº•æ˜¯å­˜å‚¨çš„`ä¸­æ–‡`è¿˜æ˜¯å­˜å‚¨çš„`è‹±æ–‡`ï¼ï¼ï¼

* è®¡ç®—æœºéœ€è¦è¿›è¡Œç¼–ç ï¼ˆå°†å­—ç¬¦é›†ä¸­æŸ¥è¯¢åˆ°çš„æ•°æ®ï¼ˆåè¿›åˆ¶æ•°å­—ï¼‰ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™è¿›è¡Œè®¡ç®—ï¼‰ï¼Œå˜ä¸ºè®¡ç®—æœºä¸­å®é™…èƒ½å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°æ®ã€‚

> [!NOTE]
>
> GBK çš„ç¼–ç æ–¹å¼ï¼ˆç¼–ç è§„åˆ™ï¼Œè®¡ç®—æœºçš„å­˜å‚¨è§„åˆ™ï¼‰ï¼šä»€ä¹ˆéƒ½ä¸åšï¼Œç›´æ¥å­˜å‚¨ã€‚

![](./assets/28.svg)



* å¦‚æœè¦è¿›è¡Œè¯»å–æ“ä½œï¼Œåªéœ€è¦å°†è®¡ç®—æœºä¸­å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œè§£ç ï¼ˆå°†å®é™…å­˜å‚¨åœ¨è®¡ç®—æœºä¸­çš„äºŒè¿›åˆ¶æ•°æ®ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™è¿›è¡Œè®¡ç®—ï¼‰ï¼Œè¿˜åŸä¸ºå­—ç¬¦é›†ä¸­å¯¹åº”çš„æ•°æ®ï¼ˆåè¿›åˆ¶æ•°å­—ï¼‰ï¼š

> [!NOTE]
>
> ASCII çš„è§£ç æ–¹å¼ï¼ˆè§£ç è§„åˆ™ï¼Œè®¡ç®—æœºçš„è§£ç è§„åˆ™ï¼‰ï¼šç›´æ¥è½¬ä¸ºåè¿›åˆ¶ã€‚

![](./assets/29.svg)

* å†æ ¹æ®è·å–åˆ°çš„æ•°æ®ï¼ˆåè¿›åˆ¶æ•°å­—ï¼‰å» GBK å­—ç¬¦é›†ä¸­æŸ¥è¯¢å¯¹åº”çš„å­—ç¬¦ï¼Œå³ï¼šè‹±æ–‡å­—ç¬¦`æ±‰`ï¼š

![](./assets/30.svg)

### 2.3.5 Unicode å­—ç¬¦é›†

#### 2.3.5.1 æ¦‚è¿°

* ä¸ºäº†æ–¹ä¾¿ç¾å›½äººæ°‘ï¼ˆæ‹‰ä¸ä½“ç³»ï¼‰ä½¿ç”¨è®¡ç®—æœºï¼Œç¾å›½æ¨å‡ºäº† ASCII å­—ç¬¦é›†ã€‚
* ä¸ºäº†æ–¹ä¾¿ä¸­å›½äººæ°‘ï¼ˆè±¡å½¢æ–‡å­—ï¼‰ä½¿ç”¨è®¡ç®—æœºï¼Œä¸­å›½æ¨å‡ºäº† GBK å­—ç¬¦é›†ã€‚
* ...

> [!NOTE]
>
> å„ä¸ªå›½å®¶éƒ½æ¨å‡ºäº†å±äºè‡ªå·±çš„å­—ç¬¦é›†ï¼Œè¿™å¾ˆä¸åˆ©äºè½¯ä»¶çš„æ¨å¹¿ä»¥åŠä¼ æ’­ï¼ˆç”¨ä¸äº†åˆ«çš„å›½å®¶çš„è½¯ä»¶ï¼‰ï¼ï¼ï¼

* ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç”±ç¾å›½ç‰µå¤´ï¼Œå¹¶è”åˆå„å¤§ç”µè„‘å‚å•†ç»„æˆäº†è”ç›Ÿï¼Œåˆ¶å®šäº† Unicode å­—ç¬¦é›†ã€‚

#### 2.3.5.2 å­˜å‚¨è§„åˆ™

* å’Œä¹‹å‰ä¸€æ ·ï¼Œå­—ç¬¦è¿›è¡Œå­˜å‚¨çš„æ—¶å€™ï¼Œéœ€è¦æ ¹æ®å­—ç¬¦å»å­—ç¬¦é›†ä¸­æŸ¥è¯¢å¯¹åº”çš„æ•°å­—ç¼–å·ï¼š

![](./assets/31.svg)

* æ¥ç€å°†æ•°å­—ç¼–å·è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°ï¼š

![](./assets/32.svg)

* è®¡ç®—æœºéœ€è¦è¿›è¡Œç¼–ç ï¼Œå˜ä¸ºè®¡ç®—æœºä¸­å®é™…èƒ½å­˜å‚¨çš„äºŒè¿›åˆ¶æ•°æ®ã€‚

> [!NOTE]
>
> ç¼–ç ï¼šå°†å­—ç¬¦é›†ä¸­æŸ¥è¯¢åˆ°çš„æ•°æ®ï¼ˆåè¿›åˆ¶æ•°å­—ï¼‰ï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™è¿›è¡Œè®¡ç®—ã€‚

* åœ¨ Uncode å­—ç¬¦é›†ä¸­æœ‰ä¸‰ç§ç¼–ç æ–¹å¼ï¼š
  * UTF-16ï¼šç”¨ 2 - 4 ä¸ªå­—èŠ‚ä¿å­˜ã€‚
  * UTF-32ï¼šç”¨ 4 ä¸ªå­—èŠ‚ä¿å­˜ã€‚
  * UTF-8ï¼šç”¨ 1 - 4 ä¸ªå­—èŠ‚ã€‚

> [!NOTE]
>
> UTFï¼ŒUniode Transfer Formatï¼Œå°† Unicode ä¸­çš„æ•°å­—è¿›è¡Œè½¬æ¢æ ¼å¼åŒ–ã€‚

* æœ€å¼€å§‹å‡ºç°çš„ç¼–ç æ–¹å¼æ˜¯`UTF-16`ï¼Œå…¶ä½¿ç”¨`2 - 4`ä¸ªå­—èŠ‚æ¥ä¿å­˜ã€‚

> [!NOTE]
>
> * â‘  å› ä¸ºæœ€å¸¸ç”¨çš„æ˜¯è½¬æ¢ä¸º`16`bitï¼Œæ‰€ä»¥å‘½åä¸º`UTF-16`ã€‚
> * â‘¡ UTF-16 å¯¹æ‹‰ä¸ä½“ç³»çš„æ–‡å­—ï¼ˆè‹±æ–‡ï¼‰éå¸¸ä¸å‹å¥½ï¼Œæœ¬æ¥å¯ä»¥ä½¿ç”¨ 1 ä¸ªå­—èŠ‚å­˜å‚¨ï¼Œå´éœ€è¦ä½¿ç”¨ 2 ä¸ªå­—èŠ‚å­˜å‚¨ï¼Œæµªè´¹ç©ºé—´ï¼ï¼ï¼

![](./assets/33.svg)

* æ¥ç€æœ‰å‡ºç°çš„ç¼–ç æ–¹å¼æ˜¯`UTF-32`ï¼Œå…¶ä½¿ç”¨`4`ä¸ªå­—èŠ‚æ¥ä¿å­˜ã€‚

> [!NOTE]
>
> * â‘  å› ä¸ºå›ºå®šä½¿ç”¨`32`ä¸ªbitï¼Œæ‰€ä»¥å‘½åä¸º`UTF-32`ã€‚
> * â‘¡ UTF-32 å¯¹æ‹‰ä¸ä½“ç³»çš„æ–‡å­—ï¼ˆè‹±æ–‡ï¼‰æ›´åŠ ä¸ä¼˜åŒ–ï¼Œå›ºå®šä½¿ç”¨4ä¸ªå­—èŠ‚æ¥å­˜å‚¨ï¼Œæ›´åŠ æµªè´¹ç©ºé—´ï¼ï¼ï¼

![](./assets/34.svg)

* ä¹‹åå‡ºç°äº†æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„ç¼–ç æ–¹å¼`UTF-8`ï¼Œå…¶ä½¿ç”¨`1-4`ä¸ªå­—èŠ‚æ¥ä¿å­˜ã€‚

> [!NOTE]
>
> * â‘  UTF-8 çš„è§„åˆ™ï¼š
>   * `å¦‚æœæ˜¯ ASCII å­—ç¬¦é›†ä¸­å‡ºç°çš„è‹±æ–‡å­—æ¯ï¼Œç»Ÿä¸€ä½¿ç”¨  1 ä¸ªå­—èŠ‚æ¥å­˜å‚¨`ã€‚
>   * å¦‚æœæ˜¯æ‹‰ä¸æ–‡ã€å¸Œè…Šæ–‡ç­‰ï¼Œç»Ÿä¸€ä½¿ç”¨ 2 ä¸ªå­—èŠ‚æ¥å­˜å‚¨ã€‚
>   * `å¦‚æœæ˜¯ä¸­æ—¥éŸ©ã€ä¸œå—äºšã€ä¸­ä¸œæ–‡å­—ï¼Œç»Ÿä¸€ä½¿ç”¨ 3 ä¸ªå­—èŠ‚æ¥å­˜å‚¨`ã€‚
>   * å¦‚æœæ˜¯å…¶ä»–è¯­è¨€ï¼Œç»Ÿä¸€ä½¿ç”¨åŠŸ 4 ä¸ªå­—èŠ‚æ¥å­˜å‚¨ã€‚
> * â‘¡ UTF-8 çš„ç¼–ç æ–¹å¼ï¼ˆå…·ä½“ç»†èŠ‚ï¼‰ï¼š
>
> | UTF-8 ç¼–ç æ–¹å¼           | äºŒè¿›åˆ¶                                      |
> | ------------------------ | ------------------------------------------- |
> | ASCII ç                  | `0`xxxxxxx                                  |
> | æ‹‰ä¸æ–‡ã€å¸Œè…Šæ–‡ç­‰         | `110`xxxxx `10`xxxxxx                       |
> | ä¸­æ—¥éŸ©ã€ä¸œå—äºšã€ä¸­ä¸œæ–‡å­— | `1110`xxxx `10`xxxxxx `10`xxxxxx            |
> | å…¶ä»–è¯­è¨€                 | `11110`xxx `10`xxxxxx `10`xxxxxx `10`xxxxxx |

![](./assets/35.svg)

* ä¹‹åçš„è¯»å–ï¼Œå°±æ˜¯å…¶å­˜å‚¨çš„ç›¸åæ“ä½œï¼š

![](./assets/36.svg)

#### 2.3.5.3 æ€»ç»“

* Unicode æ˜¯å­—ç¬¦é›†ï¼ŒUTF-8 æ˜¯Unicode å­—ç¬¦é›†ä¸­æœ€å¸¸ç”¨çš„ä¸€ç§ç¼–ç æ–¹å¼ã€‚

> [!NOTE]
>
> åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ä¼šåŒºåˆ†çš„è¿™ä¹ˆæ˜æ˜¾ï¼›å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿä¼šå°† UTF-8 è¯´æˆå­—ç¬¦ç¼–ç æˆ–å­—ç¬¦é›†ã€‚

* UTF-8 ç¼–ç æ ¼å¼çš„è§„åˆ™ï¼š

| è¯­è¨€ | UTF-8 ç¼–ç è§„åˆ™                                               |
| ---- | ------------------------------------------------------------ |
| è‹±æ–‡ | ä¸€ä¸ªè‹±æ–‡å  1 ä¸ªå­—èŠ‚ï¼ŒäºŒè¿›åˆ¶ç¬¬ä¸€ä½æ˜¯ 0ï¼Œè½¬æˆåè¿›åˆ¶æ˜¯æ­£æ•°ã€‚    |
| ä¸­æ–‡ | ä¸€ä¸ªä¸­æ–‡å  3 ä¸ªå­—èŠ‚ï¼ŒäºŒè¿›åˆ¶ç¬¬ä¸€ä½æ˜¯1ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚è½¬æˆåè¿›åˆ¶æ˜¯è´Ÿæ•°ã€‚ |

### 2.3.6 Java å¯¹å­—ç¬¦é›†çš„æ”¯æŒ

* Java æä¾›äº†è·å–å­—ç¬¦é›†çš„æ–¹æ³•ï¼š

| Charset ç±»                                                   | æè¿°                                   |
| ------------------------------------------------------------ | -------------------------------------- |
| `public static SortedMap<String,Charset> availableCharsets()` | è·å– Java å¹³å°æ”¯æŒçš„æ‰€æœ‰å­—ç¬¦é›†         |
| `public static Charset defaultCharset() `                    | è·å–å½“å‰é»˜è®¤çš„å­—ç¬¦é›†                   |
| `public static Charset forName(String charsetName) `         | è·å–æŒ‡å®šåç§°çš„å­—ç¬¦é›†                   |
| `public static boolean isSupported(String charsetName)`      | åˆ¤æ–­å½“å‰ Java å¹³å°æ˜¯å¦æ”¯æŒæŒ‡å®šçš„å­—ç¬¦é›† |

* å¯¹äºæ ‡å‡†çš„å­—ç¬¦é›†ï¼ŒJava ä¹Ÿæä¾›äº†å¸¸é‡å®šä¹‰ï¼š

| StandardCharsets ç±»                                          | æè¿°                     |
| ------------------------------------------------------------ | ------------------------ |
| `public static final Charset US_ASCII = sun.nio.cs.US_ASCII.INSTANCE;` | ASCII å­—ç¬¦é›†             |
| `public static final Charset ISO_8859_1 = sun.nio.cs.ISO_8859_1.INSTANCE;` | ISO_8859_1 å­—ç¬¦é›†        |
| `public static final Charset UTF_8 = sun.nio.cs.UTF_8.INSTANCE;` | UTF-8 ç¼–ç ï¼ˆå­—ç¬¦é›†ï¼‰     |
| `public static final Charset UTF_16BE = new sun.nio.cs.UTF_16BE();` | UTF_16BE ç¼–ç ï¼ˆå­—ç¬¦é›†ï¼‰  |
| `public static final Charset UTF_16LE = new sun.nio.cs.UTF_16LE();` | UTF_16LE  ç¼–ç ï¼ˆå­—ç¬¦é›†ï¼‰ |
| `public static final Charset UTF_16 = new sun.nio.cs.UTF_16();` | UTF_16 ç¼–ç ï¼ˆå­—ç¬¦é›†ï¼‰    |



* ç¤ºä¾‹ï¼š

```java
package com.github.io;

import java.io.IOException;
import java.nio.charset.Charset;
import java.util.SortedMap;

public class Test {
    public static void main(String[] args) throws IOException {
        SortedMap<String, Charset> stringCharsetSortedMap = Charset.availableCharsets();
        System.out.println(stringCharsetSortedMap.size()); // 173

        Charset charset = Charset.defaultCharset();
        System.out.println(charset); // UTF-8

        Charset charset2 = Charset.forName("GBK");
        System.out.println(charset2); // GBK

        System.out.println(Charset.isSupported("GBK")); // true
    }
}
```



* ç¤ºä¾‹ï¼š

```java
package com.github.io;

import java.io.IOException;
import java.nio.charset.StandardCharsets;

public class Test {
    public static void main(String[] args) throws IOException {
        System.out.println(StandardCharsets.US_ASCII);
        System.out.println(StandardCharsets.UTF_8);
        System.out.println(StandardCharsets.UTF_16);
    }
}
```

## 2.4 ä¹±ç ä»¥åŠè§£å†³æ–¹æ¡ˆ

### 2.4.1 æ¦‚è¿°

* ä¹±ç å‡ºç°çš„åŸå›  1 ï¼šè¯»å–æ•°æ®æ—¶æœªè¯»å®Œæ•´ä¸ªæ±‰å­—ã€‚
* ä¹±ç å‡ºç°çš„åŸå›  2 ï¼šç¼–ç çš„æ–¹å¼å’Œè§£ç çš„æ–¹å¼ä¸ç»Ÿä¸€ã€‚

### 2.4.2 åŸå› ä¸€

* å‡è®¾æœ‰è¿™æ ·çš„å­—ç¬¦ä¸² `abbçˆ±ä½ `ï¼Œå…¶ UTF-8 ç¼–ç æ˜¯è¿™æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](./assets/37.svg)

* ç°åœ¨ï¼Œä½¿ç”¨å­—èŠ‚æµå»è¯»å–æ•°æ®ï¼ˆä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼‰ï¼Œå°±æ˜¯è¿™æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](./assets/38.gif)

### 2.4.3 åŸå› äºŒ

* å‡è®¾æœ‰è¿™æ ·çš„å­—ç¬¦ä¸² `abbçˆ±ä½ `ï¼Œå…¶ UTF-8 ç¼–ç æ˜¯è¿™æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](./assets/37.svg)

* ä½†æ˜¯ï¼Œæ­¤æ—¶æˆ‘ä½¿ç”¨ GBK æ¥è§£ç ï¼Œå°±æ˜¯è¿™æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](./assets/39.gif)

### 2.4.4 å¦‚ä½•è§£å†³ä¹±ç ï¼Ÿ

* é’ˆå¯¹åŸå› ä¸€çš„è§£å†³æ–¹æ¡ˆï¼šä¸è¦ä½¿ç”¨å­—èŠ‚æµæ¥è¯»å–æ–‡æœ¬ã€‚
* é’ˆå¯¹åŸå› äºŒçš„è§£å†³æ–¹æ¡ˆï¼šç¼–ç å’Œè§£ç ä½¿ç”¨åŒä¸€ä¸ªç¼–ç è§„åˆ™ï¼ˆç¼–ç æ–¹å¼ï¼‰ã€‚

### 2.4.5 æ‰©å±•

* ã€é—®ã€‘å­—èŠ‚æµè¯»å–ä¸­æ–‡ä¼šä¹±ç ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆæ‹·è´æ–‡ä»¶ä¸ä¼šä¹±ç ï¼Ÿ

```java
package com.github.io;

import java.io.*;

public class Test {
    public static void main(String[] args) throws IOException {
        InputStream is = new FileInputStream("d:/a.txt");
        OutputStream os = new FileOutputStream("d:/b.txt");
        int b;
        while ((b = is.read()) != -1) {
            os.write(b);
        }
        os.close();
        is.close();
    }
}
```

* ã€ç­”ã€‘å› ä¸ºæ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚æ‹·è´çš„ï¼Œæ•°æ®å¹¶æ²¡æœ‰ä¸¢å¤±ã€‚

![](./assets/40.gif)

### 2.4.6 æ‰©å±•

* Java æä¾›äº†ç¼–ç æ–¹æ³•ï¼š

| String ç±»ä¸­çš„ç¼–ç æ–¹æ³•                          | æè¿°                                            |
| ---------------------------------------------- | ----------------------------------------------- |
| `public byte[] getBytes() {}`                  | ä½¿ç”¨é»˜è®¤çš„æ–¹å¼è¿›è¡Œç¼–ç ï¼ˆIDEA ä¸­ï¼Œé»˜è®¤æ˜¯ UTF-8ï¼‰ |
| `public byte[] getBytes(Charset charset) {}`   | ä½¿ç”¨æŒ‡å®šçš„æ–¹å¼è¿›è¡Œç¼–ç                           |
| `public byte[] getBytes(String charsetName){}` | ä½¿ç”¨æŒ‡å®šçš„æ–¹å¼è¿›è¡Œç¼–ç                           |

* Java æä¾›äº†è§£ç çš„æ–¹å¼ï¼š

| String ç±»ä¸­çš„è§£ç æ–¹æ³•                               | æè¿°                                            |
| --------------------------------------------------- | ----------------------------------------------- |
| `public String(byte[] bytes) {}`                    | ä½¿ç”¨é»˜è®¤çš„æ–¹å¼è¿›è¡Œè§£ç ï¼ˆIDEA ä¸­ï¼Œé»˜è®¤æ˜¯ UTF-8ï¼‰ |
| `public String(byte bytes[], Charset charset) {}`   | ä½¿ç”¨æŒ‡å®šçš„æ–¹å¼è¿›è¡Œè§£ç                           |
| `public String(byte bytes[], String charsetName){}` | ä½¿ç”¨æŒ‡å®šçš„æ–¹å¼è¿›è¡Œè§£ç                           |



* ç¤ºä¾‹ï¼š

```java
package com.github.io;

import java.io.IOException;
import java.util.Arrays;

public class Test {
    public static void main(String[] args) throws IOException {
        // ç¼–ç 
        String str = "abbæˆ‘çˆ±ä½ ";
        byte[] bytes = str.getBytes();
        // [97, 98, 98, -26, -120, -111, -25, -120, -79, -28, -67, -96]
        System.out.println(Arrays.toString(bytes));

        // è§£ç 
        String result = new String(bytes);
        // abbæˆ‘çˆ±ä½ 
        System.out.println(result);
    }
}
```



# ç¬¬ä¸‰ç« ï¼šåŸºæœ¬å­—ç¬¦æµï¼ˆâ­ï¼‰

## 3.1 æ¦‚è¿°

* ä¹±ç çš„å…¶ä¸­ä¸€ä¸ªåŸå› å°±æ˜¯`è¯»å–æ•°æ®çš„æ—¶æœªèƒ½è¯»å®Œæ•´ä¸ªæ±‰å­—`ã€‚

> [!NOTE]
>
> å­—èŠ‚æµæ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚çš„è¯»å–çš„ï¼Œå½“é‡åˆ°ä¸­æ–‡ï¼ˆä¸­æ–‡éœ€è¦ 3 ä¸ªå­—èŠ‚ï¼‰æ—¶å½“ç„¶ä¼šä¹±ç ã€‚

![](./assets/38.gif)

* ç°åœ¨ï¼Œæ˜¯å¦æœ‰ä¸€ç§æµï¼Ÿå¦‚æœé‡åˆ°è‹±æ–‡å°±æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚çš„è¯»å–ï¼›ä½†æ˜¯ï¼Œä¸€æ—¦é‡åˆ°ä¸­æ–‡ï¼Œå°±æ˜¯ä¸€æ¬¡è¯»å–å¤šä¸ªå­—èŠ‚ã€‚

![](./assets/41.gif)

> [!IMPORTANT]
>
> å¿…é¡»æœ‰ï¼Œè¿™å°±æ˜¯å­—ç¬¦æµï¼ï¼ï¼

## 3.2 å­—ç¬¦æµ

* å­—ç¬¦æµçš„åº•å±‚å…¶å®æ˜¯è¿˜æ˜¯å­—èŠ‚æµï¼Œåªä¸è¿‡åœ¨å­—èŠ‚æµçš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†å­—ç¬¦é›†è€Œå·²ï¼ï¼ï¼

> [!NOTE]
>
> å­—ç¬¦æµ = å­—èŠ‚æµ + å­—ç¬¦é›† 

* å­—ç¬¦æµçš„ç‰¹ç‚¹ï¼š
  *  å­—ç¬¦è¾“å…¥æµï¼šä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼›ä½†æ˜¯ï¼Œé‡åˆ°ä¸­æ–‡æ—¶ï¼Œä¸€æ¬¡è¯»å–å¤šä¸ªå­—èŠ‚ã€‚
  * å­—ç¬¦è¾“å‡ºæµï¼šåº•å±‚ä¼šå°†æ•°æ®æŒ‰ç…§æŒ‡å®šçš„ç¼–ç æ–¹å¼è¿›è¡Œç¼–ç ï¼Œå˜ä¸ºå­—èŠ‚å†å†™å…¥åˆ°æ–‡ä»¶ä¸­ã€‚

* å­—ç¬¦æµçš„ä½¿ç”¨åœºæ™¯ï¼šå¯¹äºçº¯æ–‡æœ¬æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œï¼Œå³ï¼šå¦‚æœæ–‡ä»¶ä¸­æœ‰ä¸­æ–‡ï¼Œä¸ä¼šå‡ºç°ä¹±ç ã€‚

* åŸºæœ¬å­—ç¬¦æµæœ‰ä¸¤ç§ï¼šFileWriter å’Œ FileReaderã€‚

## 3.3 FileReader

### 3.3.1 æ¦‚è¿°

* FileReader æ˜¯æ“ä½œæœ¬åœ°æ–‡ä»¶çš„å­—ç¬¦è¾“å…¥æµï¼Œå¯ä»¥å°†æœ¬åœ°æ–‡ä»¶ä¸­çš„æ•°æ®è¯»å–åˆ°ç¨‹åºä¸­ã€‚

### 3.3.2 æ“ä½œæ­¥éª¤

* â‘  åˆ›å»º FileReader çš„å¯¹è±¡ï¼š

```java
public class FileReader extends InputStreamReader {
    
    public FileReader(String fileName) throws FileNotFoundException {
        ...
    }
    
    public FileReader(File file) throws FileNotFoundException {
        ...
    }
    
    ...
    
}
```

> [!NOTE]
>
> ç»†èŠ‚ï¼šå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ç›´æ¥æŠ¥é”™ï¼ï¼ï¼

* â‘¡ è¯»æ•°æ®ï¼š

```java
public class FileReader extends InputStreamReader {
    
    // è¯»å–æ•°æ®ï¼Œè¯»åˆ°æœ«å°¾è¿”å› -1
   	public int read() throws IOException {
        ...
    }
    
    // è¯»å–æ•°æ®ï¼Œè¯»åˆ°æœ«å°¾è¿”å› -1
    public int read(char[] cbuf) throws IOException {
       ...
    }
    
    ...
    
}
```

> [!NOTE]
>
> ç»†èŠ‚ï¼š
>
> * æŒ‰å­—èŠ‚è¿›è¡Œè¯»å–ï¼Œå¦‚æœé‡åˆ°ä¸­æ–‡ï¼Œä¸€æ¬¡è¯»å–å¤šä¸ªå­—èŠ‚ï¼Œè¯»å–åè§£ç ï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°ã€‚
> * è¯»åˆ°æ–‡ä»¶æœ«å°¾ï¼Œread æ–¹æ³•è¿”å› -1 ã€‚

* â‘¢ é‡Šæ”¾èµ„æºï¼š

```java
public class FileReader extends InputStreamReader {
    
   	public void close() throws IOException {
        ...
    }
    
    ...
    
}
```



* ç¤ºä¾‹ï¼šä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—ç¬¦

::: code-group

```java [Test.java]
package com.github.io;

import java.io.FileReader;
import java.io.IOException;
import java.io.Reader;
import java.util.Arrays;

public class Test {
    public static void main(String[] args) throws IOException {
        // åˆ›å»º FileReader å¯¹è±¡
        Reader reader = new FileReader("day23\\a.txt");

        // è¯»å–æ•°æ®
        /*
         * read() æ–¹æ³•é»˜è®¤æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚çš„è¯»å–ï¼›ä½†æ˜¯ï¼Œé‡åˆ°ä¸­æ–‡å°±ä¼šä¸€æ¬¡è¯»å–å¤šä¸ª
         * è¯»å–ä¹‹åï¼Œåº•å±‚ä¼šè¿›è¡Œè§£ç å¹¶è½¬æ¢ä¸ºåè¿›åˆ¶æ•°å­—
         * 
         * read() ï¼šè¯»å–æ•°æ®ï¼Œè§£ç ï¼ˆéœ€è¦è‡ªå·±è½¬æ¢ï¼‰
         */
        int ch;
        while ((ch = reader.read()) != -1) {
            System.out.println(ch);
            System.out.println(Arrays.toString(Character.toChars(ch)));
        }

        // é‡Šæ”¾èµ„æº
        reader.close();
    }
}
```

```md:img [cmd æ§åˆ¶å°]
![](./assets/42.gif)
```

:::



* ç¤ºä¾‹ï¼šä¸€æ¬¡è¯»å–å¤šä¸ªå­—ç¬¦

::: code-group

```java [Test.java]
package com.github.io;

import java.io.FileReader;
import java.io.IOException;
import java.io.Reader;

public class Test {
    public static void main(String[] args) throws IOException {
        // åˆ›å»º FileReader å¯¹è±¡
        Reader reader = new FileReader("day23\\a.txt");

        // è¯»å–æ•°æ®
        char[] buff = new char[1024];
        int len;
        // read(chars) ï¼šè¯»å–æ•°æ®ï¼Œè§£ç ï¼Œå¼ºè½¬ä¸‰æ­¥åˆå¹¶
        while ((len = reader.read(buff)) != -1) {
            System.out.println(new String(buff, 0, len));
        }

        // é‡Šæ”¾èµ„æº
        reader.close();
    }
}
```

```md:img [cmd æ§åˆ¶å°]
![](./assets/43.gif)
```

:::

## 3.4 FileWriter

### 3.4.1 æ¦‚è¿°

* FileWriter æ˜¯æ“ä½œæœ¬åœ°æ–‡ä»¶çš„å­—ç¬¦è¾“å‡ºæµï¼Œå¯ä»¥å°†ç¨‹åºä¸­çš„æ•°æ®å†™å‡ºåˆ°æœ¬åœ°æ–‡ä»¶ä¸­ã€‚

### 3.4.2 æ“ä½œæ­¥éª¤

* â‘  åˆ›å»º FileWriter çš„å¯¹è±¡ï¼š

```java
public class FileWriter extends OutputStreamWriter {
    
    // åˆ›å»ºå­—ç¬¦è¾“å‡ºæµå¹¶å…³è”æœ¬åœ°æ–‡ä»¶
    public FileWriter(String fileName) throws IOException {
         ...
    }
    
    // åˆ›å»ºå­—ç¬¦è¾“å‡ºæµå¹¶å…³è”æœ¬åœ°æ–‡ä»¶
    public FileWriter(File file) throws IOException {
         ...
    }
    
    // åˆ›å»ºå­—ç¬¦è¾“å‡ºæµå¹¶å…³è”æœ¬åœ°æ–‡ä»¶ï¼Œç»­å†™
    public FileWriter(String fileName, boolean append) throws IOException {
         ...
    }
    
    // åˆ›å»ºå­—ç¬¦è¾“å‡ºæµå¹¶å…³è”æœ¬åœ°æ–‡ä»¶ï¼Œç»­å†™
    public FileWriter(File file, boolean append) throws IOException {
         ...
    }
    
    ...
    
}
```

> [!NOTE]
>
> ç»†èŠ‚ï¼š
>
> * å‚æ•°æ˜¯å­—ç¬¦ä¸²è¡¨ç¤ºçš„è·¯å¾„æˆ–è€… File å¯¹è±¡éƒ½æ˜¯å¯ä»¥çš„ã€‚
> * å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼›ä½†æ˜¯ï¼Œéœ€è¦ä¿è¯çˆ¶çº§è·¯å¾„æ˜¯å­˜åœ¨çš„ã€‚
> * å¦‚æœæ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œåˆ™ä¼šæ¸…ç©ºæ–‡ä»¶ï¼›å¦‚æœä¸æƒ³æ¸…ç©ºæ–‡ä»¶ï¼Œå¯ä»¥æ‰“å¼€ç»­å†™å¼€å…³ã€‚

* â‘¡ å†™æ•°æ®ï¼š

```java
public class FileWriter extends OutputStreamWriter {
    
    // å†™å‡ºä¸€ä¸ªå­—ç¬¦
    public void write(int c) throws IOException {
        ...
    }
    
    // å†™å‡ºä¸€ä¸ªå­—ç¬¦ä¸²
    public void write(String str) throws IOException {
        ...
    }
    
    // å†™å‡ºå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†
    public void write(String str, int off, int len) throws IOException {
        ...
    }
    
    // å†™å‡ºä¸€ä¸ªå­—ç¬¦æ•°ç»„
    public void write(char cbuf[]) throws IOException {
        ...
    }
    
    // å†™å‡ºå­—ç¬¦æ•°ç»„çš„ä¸€éƒ¨åˆ†
    public  void write(char cbuf[], int off, int len) throws IOException {
        ...
    }
    
    ...
    
}
```

> [!NOTE]
>
> ç»†èŠ‚ï¼šå¦‚æœ write æ–¹æ³•çš„å‚æ•°æ˜¯æ•´æ•°ï¼Œä¼šå°†å…¶ä½œä¸ºå­—ç¬¦é›†ä¸Šçš„æ•°å­—ï¼Œå¹¶è¿›è¡Œç¼–ç ï¼Œå†å†™åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ã€‚

* â‘¢ é‡Šæ”¾èµ„æºï¼š

```java
public class FileWriter extends OutputStreamWriter {
    
    public void close() throws IOException {
        ...
    }
    
    ...
    
}
```



* ç¤ºä¾‹ï¼š

::: code-group

```java [Test.java]
package com.github.io;

import java.io.FileWriter;
import java.io.IOException;
import java.io.Writer;

public class Test {
    public static void main(String[] args) throws IOException {
        // åˆ›å»º FileReader å¯¹è±¡
        Writer writer = new FileWriter("day23\\a.txt");

        // å†™å‡ºæ•°æ®
        writer.write(97);
        writer.write(29233);

        // é‡Šæ”¾èµ„æº
        writer.close();
    }
}
```

```md:img [cmd æ§åˆ¶å°]
![](./assets/44.gif)
```

:::



* ç¤ºä¾‹ï¼š

::: code-group

```java [Test.java]
package com.github.io;

import java.io.FileWriter;
import java.io.IOException;
import java.io.Writer;

public class Test {
    public static void main(String[] args) throws IOException {
        // åˆ›å»º FileReader å¯¹è±¡
        Writer writer = new FileWriter("day23\\a.txt");

        // å†™å‡ºæ•°æ®
        writer.write("ä½ å¥½å•Šï¼Œi love you");

        // é‡Šæ”¾èµ„æº
        writer.close();
    }
}
```

```md:img [cmd æ§åˆ¶å°]
![](./assets/45.gif)
```

:::

## 3.5 åº•å±‚ç»†èŠ‚

### 3.5.1 å­—ç¬¦è¾“å…¥æµ

#### 3.5.1.1 æ¦‚è¿°

* å½“æˆ‘ä»¬åˆ›å»ºå­—ç¬¦è¾“å…¥æµå¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```java
Reader reader = new FileReader("a.txt");
```

* å…¶å®ï¼Œå°±ç›¸å½“äº Java ç¨‹åºï¼ˆå†…å­˜ï¼‰å’Œæ–‡ä»¶ä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªè¿æ¥çš„é€šé“ï¼š

![](./assets/49.svg)

* å…¶å®ï¼Œåœ¨åº•å±‚ä¼šåˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 8192 çš„å­—èŠ‚æ•°ç»„ï¼ˆç¼“å†²åŒºï¼‰ï¼š

![](./assets/50.svg)

* å‡è®¾æˆ‘ä»¬è¦è¯»å–å­—ç¬¦çš„ä»£ç æ˜¯è¿™æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```java
int ch;
ch = reader.read();
System.out.println((char) ch);
ch = reader.read();
System.out.println((char) ch);
ch = reader.read();
System.out.println((char) ch);
ch = reader.read();
System.out.println((char) ch);
```

* å½“ä»£ç å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```java
int ch; // [!code highlight]
ch = reader.read();
System.out.println((char) ch);
ch = reader.read();
System.out.println((char) ch);
ch = reader.read();
System.out.println((char) ch);
ch = reader.read();
System.out.println((char) ch);
```

* å…¶ä¼šåœ¨å†…å­˜ä¸­å¼€è¾Ÿä¸€ä¸ªä¸´æ—¶çš„å˜é‡ ch ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![](./assets/51.gif)

* ä»£ç ç»§ç»­æ‰§è¡Œï¼Œè¿›è¡Œè¯»å–æ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```java
int ch; 
ch = reader.read(); // [!code highlight]
System.out.println((char) ch);
ch = reader.read();
System.out.println((char) ch);
ch = reader.read();
System.out.println((char) ch);
ch = reader.read();
System.out.println((char) ch);
```

* å…¶åº•å±‚ä¼šä»ç¼“å†²åŒºä¸­è¯»å–æ•°æ®ï¼Œä½†æ˜¯ä¼šé‡åˆ°ä¸¤ç§æƒ…å†µï¼š
  * å¦‚æœç¼“å†²åŒºä¸­æ²¡æœ‰æ•°æ®ï¼Œé‚£ä¹ˆå°±ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œå¹¶å°½å¯èƒ½çš„è£…æ»¡ç¼“å†²åŒºã€‚
  * å¦‚æœç¼“å†²åŒºä¸­æœ‰ï¼Œç›´æ¥ä»ç¼“å†²åŒºä¸­è¯»å–ï¼Œå¹¶èµ‹å€¼ç»™ä¸´æ—¶å˜é‡ ch ã€‚

> [!NOTE]
>
> * â‘  å¦‚æœæ¯æ¬¡éƒ½æ˜¯ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼ˆç¡¬ç›˜å’Œå†…å­˜çš„é€Ÿåº¦ç›¸å¯¹å·®å¤ªå¤šï¼Œä¼šå¯¼è‡´é¢‘ç¹çš„ IO æ“ä½œï¼‰ï¼Œæ•ˆç‡å¾ˆä½ã€‚
> * â‘¡ ä¸€æ—¦æœ‰äº†ç¼“å†²ä¹‹åï¼Œå°†å¤§å¤§é™ä½ç¡¬ç›˜å’Œå†…å­˜çš„ IO æ¬¡æ•°ï¼Œæé«˜äº†æ•ˆç‡ã€‚

![](./assets/52.gif)

#### 3.5.1.2 è¯æ˜

* â‘  æˆ‘ä»¬å¯ä»¥é€šè¿‡ IDEA çš„ debug åŠŸèƒ½æ¥è¯æ˜ï¼š

![](./assets/53.gif)

* â‘¡ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æºç æ¥è¯æ˜ï¼š

![](./assets/54.png)

#### 3.5.1.3 æ€»ç»“

* â‘  åˆ›å»ºå­—ç¬¦æµè¾“å…¥å¯¹è±¡ï¼Œå…¶åº•å±‚æ˜¯å…³è”å¯¹è±¡ï¼Œå¹¶åˆ›å»ºç¼“å†²åŒºã€‚

> [!NOTE]
>
> ç¼“å†²åŒºæ˜¯é•¿åº¦ä¸º 8192 çš„å­—èŠ‚æ•°ç»„ã€‚

* â‘¡ è¯»å–æ•°æ®ï¼Œå…¶åº•å±‚ä¼šåˆ¤æ–­ç¼“å†²åŒºä¸­æ˜¯å¦æœ‰æ•°æ®å¯ä»¥è¯»å–ã€‚

> [!NOTE]
>
> * å¦‚æœç¼“å†²åŒºä¸­æ²¡æœ‰æ•°æ®ï¼šå°±ä»æ–‡ä»¶ä¸­è·å–æ•°æ®ï¼Œå¹¶å°½é‡è£…æ»¡ç¼“å†²åŒºï¼ˆå¦‚æœæ–‡ä»¶ä¸­ä¹Ÿæ²¡æœ‰æ•°æ®ï¼Œåˆ™è¿”å› -1 ï¼‰ã€‚
> * å¦‚æœç¼“å†²åŒºä¸­æœ‰æ•°æ®ï¼šå°±ä»ç¼“å†²åŒºä¸­è¯»å–ã€‚
>   * ç©ºå‚çš„ read() æ–¹æ³•ï¼šä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œé‡åˆ°ä¸­æ–‡å°±è¯»å–å¤šä¸ªå­—èŠ‚ï¼Œå¹¶å°†å­—èŠ‚è§£ç å¹¶è½¬æ¢æˆåè¿›åˆ¶è¿”å›ã€‚
>   * æœ‰å‚çš„ read() æ–¹æ³•ï¼šå°†è¯»å–å­—èŠ‚ã€è§£ç ä»¥åŠå¼ºè½¬ä¸‰æ­¥åˆå¹¶ï¼Œå¼ºè½¬ä¹‹åçš„å­—ç¬¦æ”¾åˆ°æ•°ç»„ä¸­ã€‚

### 3.5.2 å­—ç¬¦è¾“å‡ºæµ

#### 3.5.2.1 æ¦‚è¿°

* å½“æˆ‘ä»¬åˆ›å»ºå­—ç¬¦è¾“å‡ºæµå¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```java
Writer writer = new FileWriter("day23\\a.txt");
```

* å…¶å®ï¼Œå°±ç›¸å½“äº Java ç¨‹åºï¼ˆå†…å­˜ï¼‰å’Œæ–‡ä»¶ä¹‹é—´å»ºç«‹äº†ä¸€ä¸ªè¿æ¥çš„é€šé“ï¼š

![](./assets/55.svg)

* å…¶å®ï¼Œåœ¨åº•å±‚ä¼šåˆ›å»ºäº†ä¸€ä¸ªé•¿åº¦ä¸º 8192 çš„å­—èŠ‚æ•°ç»„ï¼ˆç¼“å†²åŒºï¼‰ï¼š

![](./assets/56.svg)

* å‡è®¾æˆ‘ä»¬è¦å†™å‡ºå­—ç¬¦çš„ä»£ç æ˜¯è¿™æ ·çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```java
writer.write("é”„ç¦¾æ—¥å½“åˆ");
writer.write("æ±—æ»´ç¦¾ä¸‹åœŸ");
writer.write("è°çŸ¥ç›˜ä¸­é¤");
writer.write("ç²’ç²’çš†è¾›è‹¦");
```

* å½“ä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼Œå…¶ä¼šæš‚æ—¶ä¿å­˜åˆ°ç¼“å†²åŒºä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![ä¿å­˜åˆ°ç¼“å†²åŒºï¼Œä¼šæ ¹æ® UTF-8 è¿›è¡Œè§£ç ï¼Œå›¾ä¸Šæ˜¯ä¸ºäº†ç®€åŒ–](./assets/57.gif)

* å½“æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œå°†ä¼šå°†ç¼“å†²åŒºä¸­çš„æ•°æ®åˆ·æ–°åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ï¼š
  * â‘  ç¼“å†²åŒºæ»¡äº†ï¼Œä¸éœ€è¦æˆ‘ä»¬åšä»»ä½•æ“ä½œã€‚
  * â‘¡ æ‰‹åŠ¨è°ƒç”¨ `writer.flush()` æ–¹æ³•ï¼Œåˆ·æ–°ä¹‹åï¼Œè¿˜å¯ä»¥ç»§ç»­å‘æ–‡ä»¶ä¸­å†™å‡ºæ•°æ®ã€‚
  * â‘¢ é‡Šæ”¾èµ„æºï¼Œå³ï¼š`writer.close()` ã€‚

| æˆå‘˜æ–¹æ³•              | æè¿°                                                       |
| --------------------- | ---------------------------------------------------------- |
| `public void flush()` | å°†ç¼“å†²åŒºä¸­çš„æ•°æ®åˆ·æ–°åˆ°æœ¬åœ°æ–‡ä»¶ï¼Œè¿˜å¯ä»¥ç»§ç»­å‘æ–‡ä»¶ä¸­å†™å‡ºæ•°æ® |
| `public void close()` | é‡Šæ”¾èµ„æºï¼Œå³ï¼šæ–­å¼€é€šé“ï¼Œæ— æ³•å†å¾€æ–‡ä»¶ä¸­å†™å‡ºæ•°æ®             |

![](./assets/58.gif)

#### 3.5.2.2 è¯æ˜

* å¯ä»¥é€šè¿‡ IDEA çš„ debug åŠŸèƒ½æ¥è¯æ˜ï¼š

![](./assets/59.gif)



# ç¬¬å››ç« ï¼šç»¼åˆç»ƒä¹ 

## 4.1 æ¦‚è¿°

* å­—èŠ‚æµå¯ä»¥è¯»å–ä»»æ„ç±»å‹çš„æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæ–‡ä»¶å¤åˆ¶ï¼ˆæ‹·è´ï¼‰çš„åœºæ™¯ã€‚
* å­—ç¬¦æµåªèƒ½è¯»å–çº¯æ–‡æœ¬æ–‡ä»¶ã€‚

## 4.2 ç»¼åˆç»ƒä¹ ä¸€

* éœ€æ±‚ï¼šæ‹·è´ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œéœ€è¦è€ƒè™‘å­æ–‡ä»¶å¤¹ã€‚

> [!NOTE]
>
> * â‘  éœ€è¦è€ƒè™‘å­æ–‡ä»¶å¤¹ï¼Œå°±éœ€è¦ä½¿ç”¨é€’å½’æŠ€æœ¯ã€‚
> * â‘¡ æ‹·è´ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå°±éœ€è¦è€ƒè™‘å­—èŠ‚æµæŠ€æœ¯ã€‚



* ç¤ºä¾‹ï¼š

::: code-group

```java [Test.java]
package com.github.io;

import java.io.*;
import java.util.Objects;

public class Test {
    public static void main(String[] args) throws IOException {
        // åˆ›å»º File å¯¹è±¡è¡¨ç¤ºæ•°æ®æº
        File src = new File("D:\\test\\src");
        // åˆ›å»º File å¯¹è±¡è¡¨ç¤ºç›®çš„åœ°
        File dest = new File("D:\\test\\dest");
        // å¤åˆ¶æ–‡ä»¶å¤¹
        copyDir(src, dest);
    }


    public static void copyDir(File src, File dest) throws IOException {
        // å¦‚æœç›®çš„åœ°æ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º
        if (!dest.exists()) {
            dest.mkdirs();
        }
        // è¿›å…¥æ•°æ®æº
        File[] files = src.listFiles();
        // éå†
        for (File file : Objects.requireNonNullElse(files, new File[0])) {
            // å¦‚æœæ˜¯æ–‡ä»¶ï¼Œç›´æ¥å¤åˆ¶
            if (file.isFile()) {
                InputStream is = new FileInputStream(file);
                OutputStream os = new FileOutputStream(
                    new File(dest, file.getName()));
                byte[] buf = new byte[1024];
                int len;
                while ((len = is.read(buf)) != -1) {
                    os.write(buf, 0, len);
                }
                os.close();
                is.close();
            } else {
                // å¦‚æœæ˜¯ç›®å½•ï¼Œå°±é€’å½’
                copyDir(file, new File(dest, file.getName()));
            }

        }

    }
}
```

```md:img [cmd æ§åˆ¶å°]
![](./assets/46.gif)
```

:::

## 4.3 ç»¼åˆç»ƒä¹ äºŒ

* éœ€æ±‚ï¼šä¸ºäº†ä¿è¯æ–‡ä»¶çš„å®‰å…¨æ€§ï¼Œéœ€è¦å¯¹åŸå§‹æ–‡ä»¶è¿›è¡ŒåŠ å¯†å­˜å‚¨ï¼Œä½¿ç”¨çš„æ—¶å€™å†è¿›è¡Œè§£å¯†å¤„ç†ã€‚

> [!NOTE]
>
> * åŠ å¯†åŸç†ï¼šå¯¹åŸå§‹æ–‡ä»¶ä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚æ•°æ®è¿›è¡Œæ›´æ”¹ï¼Œå°†æ›´æ”¹åçš„æ•°æ®å­˜å‚¨åˆ°æ–°æ–‡ä»¶ä¸­ã€‚
> * è§£å¯†åŸç†ï¼šè¯»å–åŠ å¯†åçš„æ–‡ä»¶ï¼ŒæŒ‰ç…§åŠ å¯†çš„è§„åˆ™åå‘æ“ä½œï¼Œå˜æˆåŸå§‹æ–‡ä»¶ã€‚
> * æ‰€è°“çš„åŠ å¯†è§„åˆ™å’Œè§£å¯†è§„åˆ™ï¼Œå¯ä»¥ä½¿ç”¨å¼‚æˆ–è¿ç®—ï¼Œå³ï¼š a ^ b ^ b = a ^ 0 = a ã€‚



* ç¤ºä¾‹ï¼š

 ::: code-group

```java [Test.java]
package com.github.io;

import java.io.*;
import java.nio.charset.StandardCharsets;

public class Test {
    public static void main(String[] args) throws IOException {
        File src = new File("day23\\a.txt");
        File temp = new File("day23\\tmp.txt");
        File dest = new File("day23\\b.txt");
        encryptionAndDecryption(src, temp, "123");
        encryptionAndDecryption(temp, dest, "123");
    }


    /**
     * åŠ å¯†å’Œè§£å¯†
     */
    public static void encryptionAndDecryption(File src, File dest, String salt) 
        throws IOException {
        
        InputStream is = new FileInputStream(src);
        OutputStream os = new FileOutputStream(dest);

        byte[] buffer = new byte[1024];
        int len;
        while ((len = is.read(buffer)) != -1) {
            byte[] saltBytes = salt.getBytes(StandardCharsets.UTF_8);
            for (int i = 0; i < len; i++) {
                buffer[i] ^= saltBytes[i % saltBytes.length];
            }
            os.write(buffer, 0, len);
        }
        
        os.close();
        is.close();
    }
}
```

```md:img [cmd æ§åˆ¶å°]
![](./assets/47.gif)
```

:::

## 4.4 ç»¼åˆç»ƒä¹ ä¸‰

* éœ€æ±‚ï¼šå¯¹æ–‡ä»¶ä¸­çš„æ•°æ®è¿›è¡Œæ’åºã€‚

> [!NOTE]
>
> * â‘  åŸæ¥çš„æ•°æ®æ˜¯ 2-1-9-4-7-8 ï¼Œè½¬æ¢ä¹‹ååº”è¯¥æ˜¯ 1-2-4-7-8-9 ã€‚
> * â‘¡ å…ˆå°†æ•°æ®ä»æ–‡ä»¶è¯»å–åˆ° Java ä¸­ï¼Œç„¶åè¿›è¡Œè½¬æ¢ä¹‹åï¼Œå†å†™å‡ºåˆ°åŸæ¥çš„æ–‡ä»¶ã€‚



* ç¤ºä¾‹ï¼š

 ::: code-group

```java [Test.java]
package com.github.io;

import java.io.*;
import java.util.Arrays;
import java.util.stream.Collectors;

public class Test {
    public static void main(String[] args) throws IOException {
        File file = new File("day23\\a.txt");
        sort(file);
    }

    /**
     * æ’åº
     */
    public static void sort(File file) throws IOException {
        // å°†æ•°æ®è¯»å–åˆ° StringBuilder å¯¹è±¡ä¸­
        Reader reader = new FileReader(file);
        StringBuilder sb = new StringBuilder();
        char[] buffer = new char[1024];
        int len;
        while ((len = reader.read(buffer)) != -1) {
            sb.append(buffer, 0, len);
        }
        // å¯¹ StringBuilder å¯¹è±¡ä¸­çš„æ•°æ®è¿›è¡Œæ’åº
        String result = Arrays
                .stream(sb
                        .toString()
                        .split("-"))
                .mapToInt(Integer::parseInt)
                .sorted()
                .mapToObj(Integer::toString)
                .collect(Collectors.joining("-"));
        System.out.println(result);
        // å°†æ’åºåçš„æ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­
        Writer writer = new FileWriter(file);
        writer.write(result);
        writer.flush();
        writer.close();
    }
}

```

```md:img [cmd æ§åˆ¶å°]
![](./assets/48.gif)
```

:::

