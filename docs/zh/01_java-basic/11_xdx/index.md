# 第一章 JDK17之前

在 Java 中，编码的默认字符集是 **Unicode**，但具体实现上，Java 支持多种字符编码标准，包括 **UTF-8**、**UTF-16**、**UTF-32** 等。

让我们来厘清几个关键概念：

1. **Unicode** 是一种字符集标准，目的是为全球所有语言的字符提供一个唯一的编码，涵盖了几乎所有的字符，包括常见的英语字符、汉字、符号等。Unicode 为每个字符分配了一个唯一的编码点。
2. **UTF-8**、**UTF-16**、**UTF-32** 是 Unicode 的具体编码方式。它们都是将 Unicode 编码点转换为字节序列的不同方法：

   - **UTF-8**：变长编码方式，每个字符使用 1 到 4 个字节来表示，兼容 ASCII。
   - **UTF-16**：每个字符使用 2 或 4 个字节，通常以两字节为主。
   - **UTF-32**：每个字符固定使用 4 个字节。

### 在 Java 中：

- **字符串（String）** 在内存中的表示方式是 **UTF-16** 编码。也就是说，Java 中的 `String` 类是基于 UTF-16 编码来存储字符的。
- **文件读写**：Java 提供了多种方式来指定字符编码。当你使用 `InputStreamReader` 或 `OutputStreamWriter` 等类时，你可以指定字符编码。例如，默认情况下 Java 使用 **平台默认编码**，但你可以明确指定 UTF-8 或其他编码。

  ```java
  // 使用 UTF-8 编码读取文件
  InputStreamReader reader = new InputStreamReader(new FileInputStream("file.txt"), "UTF-8");
  ```

  默认情况下，Java 在不同的操作系统上可能会使用不同的默认编码（例如 Windows 上通常是 **GBK** 或 **ISO-8859-1**，而 Linux 上通常是 **UTF-8**）。

### 总结：

- Java 的字符串是基于 **UTF-16** 编码表示的。
- 但 Java 也支持多种字符编码，如 **UTF-8**、**ISO-8859-1** 等，用于文件读写、网络通信等场景。

如果你需要在不同编码之间转换，可以使用 `Charset` 类或者指定编码格式来进行转换。

你提到的是 **JDK 18**，确实从 **JDK 18** 开始，Java 对默认字符编码做了一些变化，特别是在 **文件和网络操作** 时的字符编码处理上。



# 第二章：JDK 18 的变化

在 **JDK 18** 中，Java 引入了一个新的 **默认字符集**，它的默认编码方式发生了改变，主要是在 **文件和网络操作** 相关的地方。

#### 1. **默认编码的变化**

在 JDK 18 之前，Java 的默认字符集通常是根据操作系统的本地环境来确定的，比如：

- Windows 通常是 **Windows-1252** 或 **GBK**。
- Linux 和 macOS 上通常是 **UTF-8**。

但从 JDK 18 开始，Java 更倾向于统一使用 **UTF-8** 作为默认字符集，不再根据操作系统的默认编码来决定。这是为了确保跨平台的一致性，减少因字符编码不一致而导致的问题。

#### 2. **文件 I/O 的影响**

具体来说，如果你使用了不带字符编码的 I/O 操作（比如 `Files.readAllLines()` 或者 `BufferedReader`），在 JDK 18 之后，如果没有明确指定字符编码，Java 将默认使用 **UTF-8**。

例如：

```java
// 在 JDK 17 或之前的版本中，默认编码可能会根据系统环境变化
List<String> lines = Files.readAllLines(Paths.get("file.txt")); // 可能使用不同的默认编码

// 在 JDK 18 及之后的版本中，这将默认使用 UTF-8 编码
```

### 为什么改变？

这种变化的目的是减少在不同操作系统之间使用 Java 时出现的字符编码不一致问题。UTF-8 是一种广泛使用且兼容性好的编码方式，能够确保在不同平台之间的一致性。

### 3. **如何指定字符编码**

如果你需要在 JDK 18 中仍然使用其他编码（例如 `ISO-8859-1` 或 `GBK`），你可以通过显式指定编码来确保正确性。例如：

```java
// 明确指定 UTF-16 编码读取文件
List<String> lines = Files.readAllLines(Paths.get("file.txt"), StandardCharsets.UTF_16);
```

### 总结

- **JDK 18** 开始，Java **默认使用 UTF-8** 作为字符编码，而不再依赖于操作系统的默认编码。
- 这种变化主要影响 **文件读写** 和 **I/O 操作**，如果你不指定字符编码，Java 会使用 UTF-8。
- 如果你需要其他编码，可以明确指定，例如 `StandardCharsets.UTF_8`、`StandardCharsets.ISO_8859_1` 等。

这个变化使得跨平台编程更加一致，减少了因默认字符集不同而导致的潜在问题。如果你的代码运行在不同平台上，推荐使用 UTF-8 来确保一致性。
